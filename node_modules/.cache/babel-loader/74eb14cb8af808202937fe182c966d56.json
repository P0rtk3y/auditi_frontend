{"ast":null,"code":"import _defineProperty from\"/Users/skout/Desktop/Auditi/auditi_frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/Users/skout/Desktop/Auditi/auditi_frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/skout/Desktop/Auditi/auditi_frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/skout/Desktop/Auditi/auditi_frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/skout/Desktop/Auditi/auditi_frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/skout/Desktop/Auditi/auditi_frontend/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{connect}from'react-redux';import{Icon,Form,Button,Grid}from'semantic-ui-react';// import { Link } from 'react-router-dom'\nimport{ReactMic}from'react-mic';import Pizzicato from'pizzicato';import OnEvent from'react-onevent';import{updateAudioForm,createRecording}from'../actions/audioForm.js';import{addAudiocard}from'../actions/myAudioCards.js';var Recorder=/*#__PURE__*/function(_React$Component){_inherits(Recorder,_React$Component);var _super=_createSuper(Recorder);function Recorder(props){var _this;_classCallCheck(this,Recorder);_this=_super.call(this);_this.startRecording=function(){_this.setState({record:true});};_this.playRecording=function(){if(_this.state.blob&&_this.state.playing){_this.state.blob.play();}};_this.stopRecording=function(){_this.state.blob.pause();};_this.onStop=function(micFeedback){console.log(micFeedback);var getSound=new Pizzicato.Sound({source:'file',options:{path:micFeedback.blobURL}},function(){// this.setState({soundfile: getSound}\nvar fileNameLength=micFeedback.blobURL.split('/').length;var fileName=micFeedback.blobURL.split('/')[fileNameLength-1]+'.webm';var file=new File([micFeedback.blob],fileName,{type:micFeedback.blob.type});// console.log(file)\n_this.setState({soundfile:file});_this.setState({blob:new Audio(micFeedback.blobURL)});// this.props.addRecording({soundfile: getSound, blob: micFeedback.blobURL}\n});_this.setState({playing:true});};_this.addTag=function(e){var newNoSpaceTag=\"\".concat(e.target.value.trim());if(!_this.state.tags.includes(newNoSpaceTag)&&_this.state.tags.length<5){_this.setState({tags:[].concat(_toConsumableArray(_this.state.tags),[newNoSpaceTag])});e.target.value='';}};_this.deleteTag=function(removeTag){var filteredTags=_this.state.tags.filter(function(tag){return tag!==removeTag;});_this.setState({tags:filteredTags});};_this.handleChange=function(e,_ref){var name=_ref.name,value=_ref.value;_this.setState(_defineProperty({},name,value));};_this.handleSubmit=function(e){e.preventDefault();// const recorderFormData = {\n//     category: this.state.category,\n//     tags: this.state.tags,\n//     soundfile: this.state.soundfile,\n//     soundster: this.state.soundster,\n//     image: `https://loremflickr.com/g/200/200/${this.state.tags[0]}`,\n//     favorite: false,\n//     user_id: this.props.userId\n//     // storedBlob: this.state.blob\n// }\nvar formData=new FormData();formData.append('audiocard[soundfile]',_this.state.soundfile);formData.append('audiocard[category]',_this.state.category);formData.append('audiocard[tags]',JSON.stringify(_this.state.tags));formData.append('audiocard[soundster]',_this.state.soundster);formData.append('audiocard[image]',\"https://loremflickr.com/g/200/200/\".concat(_this.state.tags[0]));formData.append('audiocard[favorite]',false);formData.append('audiocard[user_id]',_this.props.userId);// this.props.updateAudioForm(recorderFormData)\n// blob conversion\n// let newAudio = new Audio(this.state.blob)\nif(Object.values(_this.state).every(function(k){return k!==\"\"||k.length!==0;})){_this.setState({displayErrors:false});alert(\"Successfully Saved!\");_this.props.createRecording(formData);}else{return _this.setState({displayErrors:true});}};_this.state={record:false,soundfile:'',tags:[],category:'',soundster:'',blob:'',favorite:false,displayErrors:false,playing:false};return _this;}//Recording Methods\n_createClass(Recorder,[{key:\"render\",value:function render(){var _this2=this;//animate gears \nvar rotateGears=function rotateGears(e){document.querySelector('.gear1').style.animation=\"rotation 8s infinite linear\";document.querySelector('.gear2').style.animation=\"rotation 8s infinite linear\";_this2.startRecording();console.log(\"RECORDING\");};var stopGears=function stopGears(e){document.querySelector('.gear1').style.animation=\"\";document.querySelector('.gear2').style.animation=\"\";_this2.setState({record:false});if(_this2.state.playing){_this2.stopRecording();}console.log(\"STOPPING\");};var playGears=function playGears(e){document.querySelector('.gear1').style.animation=\"rotation 8s infinite linear\";document.querySelector('.gear2').style.animation=\"rotation 8s infinite linear\";_this2.playRecording();console.log(\"PLAYING\");};//options for category input\nvar categoryOptions=[{key:1,value:'quotes',text:'quotes',icon:'comment alternate'},{key:2,text:'Music',value:'music',icon:'music'},{key:3,text:'Nature',value:'nature',icon:'leaf'},{key:4,text:'Joke',value:'joke',icon:'smile'},{key:5,text:'Health',value:'health',icon:'hand spock'},{key:6,text:'Personal',value:'personal',icon:'user secret'},{key:7,text:'Mechanical',value:'mechanical',icon:'wrench'},{key:8,text:'Other',value:'other',icon:'find'}];var getclassName=this.state.displayErrors?'displayErrors':'';return/*#__PURE__*/React.createElement(\"div\",{className:\"mainRecContainer\"},/*#__PURE__*/React.createElement(Form,{className:getclassName,onSubmit:this.handleSubmit,noValidate:true},/*#__PURE__*/React.createElement(\"div\",{className:\"cassette\"},/*#__PURE__*/React.createElement(\"div\",{className:\"gear1\"},/*#__PURE__*/React.createElement(\"span\",{className:\"helper\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"gear2\"},/*#__PURE__*/React.createElement(\"span\",{className:\"helper\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"soundsterContainer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"soundster-input\"},/*#__PURE__*/React.createElement(Form.Input,{onChange:this.handleChange,className:\"soundster-input-box\",placeholder:\"Sound source\",name:\"soundster\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"category-input\"},/*#__PURE__*/React.createElement(Form.Select,{onChange:this.handleChange,placeholder:\"Category\",options:categoryOptions,name:\"category\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"tag-input\",style:{width:\"550px\"}},/*#__PURE__*/React.createElement(Grid,null,/*#__PURE__*/React.createElement(Grid.Row,{columns:2},/*#__PURE__*/React.createElement(Grid.Column,{width:6},/*#__PURE__*/React.createElement(OnEvent,{space:this.addTag},/*#__PURE__*/React.createElement(Form.Input,{style:{width:\"200px\"},placeholder:\"Add tags\",name:\"addTags\",icon:true},/*#__PURE__*/React.createElement(\"input\",null),/*#__PURE__*/React.createElement(Icon,{name:\"tag\"})))),/*#__PURE__*/React.createElement(Grid.Column,{width:10},/*#__PURE__*/React.createElement(Grid,null,/*#__PURE__*/React.createElement(Grid.Row,{columns:2},this.state.tags.map(function(tag,index){return/*#__PURE__*/React.createElement(Button,{onClick:function onClick(e){return _this2.deleteTag(tag);},color:\"teal\",icon:true,name:\"delete\",key:index,labelPosition:\"right\",style:{margin:\"10px 5px 0px 10x\"}},tag,/*#__PURE__*/React.createElement(Icon,{name:\"delete\"}));}))))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"recordingContainer\"},/*#__PURE__*/React.createElement(ReactMic,{record:this.state.record,className:\"sound-wave\",onStop:this.onStop,strokeColor:\"#D4E6D7\",backgroundColor:\"#8FC6B4\",mimeType:\"audio/webm\",duration:30})),/*#__PURE__*/React.createElement(Form.Group,{className:\"recorderButtons\",style:{margin:\"10px 0px 10px 465px\"}},/*#__PURE__*/React.createElement(Form.Button,{type:\"button\",attached:\"bottom\",className:\"recordButton\",color:\"olive\",onClick:rotateGears},/*#__PURE__*/React.createElement(Icon,{name:\"microphone\"}),\"Record\"),/*#__PURE__*/React.createElement(Form.Button,{type:\"onStop\",attached:\"bottom\",className:\"stopButton\",onClick:stopGears},/*#__PURE__*/React.createElement(Icon,{name:\"stop\"}),\"Stop\"),/*#__PURE__*/React.createElement(Form.Button,{type:\"button\",attached:\"bottom\",className:\"playButton\",onClick:playGears},/*#__PURE__*/React.createElement(Icon,{name:\"play\"}),\"Play\"),/*#__PURE__*/React.createElement(Form.Button,{type:\"Submit\",className:\"saveButton\",color:\"orange\"},/*#__PURE__*/React.createElement(Icon,{name:\"paper plane outline\"}),\"Save\"))));}}]);return Recorder;}(React.Component);var mapStateToProps=function mapStateToProps(state){var userId=state.currentUser?state.currentUser.id:\"\";return{audioForm:state.audioForm,userId:userId};};// const mapStateToProps = state => {\n//     return {\n//         storedRecording: state.storedRecording,\n//         blob: state.storedBlob\n//     }\n// }\nexport default connect(mapStateToProps,{updateAudioForm:updateAudioForm,createRecording:createRecording,addAudiocard:addAudiocard})(Recorder);","map":{"version":3,"sources":["/Users/skout/Desktop/Auditi/auditi_frontend/src/components/Recorder.js"],"names":["React","connect","Icon","Form","Button","Grid","ReactMic","Pizzicato","OnEvent","updateAudioForm","createRecording","addAudiocard","Recorder","props","startRecording","setState","record","playRecording","state","blob","playing","play","stopRecording","pause","onStop","micFeedback","console","log","getSound","Sound","source","options","path","blobURL","fileNameLength","split","length","fileName","file","File","type","soundfile","Audio","addTag","e","newNoSpaceTag","target","value","trim","tags","includes","deleteTag","removeTag","filteredTags","filter","tag","handleChange","name","handleSubmit","preventDefault","formData","FormData","append","category","JSON","stringify","soundster","userId","Object","values","every","k","displayErrors","alert","favorite","rotateGears","document","querySelector","style","animation","stopGears","playGears","categoryOptions","key","text","icon","getclassName","width","map","index","margin","Component","mapStateToProps","currentUser","id","audioForm"],"mappings":"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","sourcesContent":["\nimport React from 'react'\nimport { connect } from 'react-redux'\nimport { Icon, Form, Button, Grid } from 'semantic-ui-react'\n// import { Link } from 'react-router-dom'\nimport { ReactMic } from 'react-mic'\nimport Pizzicato from 'pizzicato'\nimport OnEvent from 'react-onevent'\nimport { updateAudioForm, createRecording} from '../actions/audioForm.js'\nimport { addAudiocard } from '../actions/myAudioCards.js'\n\n\nclass Recorder extends React.Component {\n    constructor(props) {\n      super();\n      this.state = {\n        record: false,\n        soundfile: '',\n        tags: [],\n        category: '',\n        soundster: '',\n        blob: '',\n        favorite: false,\n        displayErrors: false,\n        playing: false\n        }\n      }\n    \n    //Recording Methods\n    startRecording = () => {\n      this.setState({\n        record: true\n      });\n\n    }\n\n    playRecording = () => {\n        if (this.state.blob && this.state.playing){\n            this.state.blob.play()\n        } \n    }\n\n    stopRecording = () => {\n        this.state.blob.pause()\n    }\n\n    \n    onStop = (micFeedback) => {\n        console.log(micFeedback)\n        const getSound = new Pizzicato.Sound({\n            source: 'file',\n            options: {path: micFeedback.blobURL}\n        }, () => {\n            // this.setState({soundfile: getSound}\n            let fileNameLength = micFeedback.blobURL.split('/').length\n            let fileName = micFeedback.blobURL.split('/')[fileNameLength - 1] + '.webm'\n            let file = new File([micFeedback.blob], fileName, {type:micFeedback.blob.type})\n            // console.log(file)\n            this.setState({soundfile: file})\n            this.setState({blob: new Audio(micFeedback.blobURL)})\n            // this.props.addRecording({soundfile: getSound, blob: micFeedback.blobURL}\n        })\n        this.setState({playing: true})\n    }\n\n    \n\n    // onStop = (micFeedback) => {\n    //     let url = URL.createObjectURL(micFeedback.blob)\n    //     URL.revokeObjectURL(url)\n    //     let reader = new FileReader()\n    //         reader.readAsDataURL(micFeedback.blob)\n    //     let base64FileData = reader.result.toString()\n    //     let mediaFile = {\n    //         fileUrl: url,\n    //         size: micFeedback.blob.size,\n    //         type: micFeedback.blob.type,\n    //         src: base64FileData\n    //     };\n    //     this.setState({soundfile: mediaFile})       \n    // }\n\n    // Tag input methods\n\n    addTag = e => {\n        let newNoSpaceTag = `${e.target.value.trim()}`\n        if(!this.state.tags.includes(newNoSpaceTag) && this.state.tags.length < 5){\n            this.setState({\n                tags: [...this.state.tags, newNoSpaceTag]\n            })\n            e.target.value = ''\n        } \n    }\n\n    deleteTag = removeTag => {\n        const filteredTags = this.state.tags.filter(tag => {\n            return tag !== removeTag\n        })        \n        this.setState({\n            tags: filteredTags\n        })  \n    }\n\n    //event handlers\n\n    handleChange = (e, {name,value}) => {\n        this.setState({\n            [name]: value\n        })\n    }\n\n    handleSubmit = e => {\n        e.preventDefault()\n\n         \n        // const recorderFormData = {\n        //     category: this.state.category,\n        //     tags: this.state.tags,\n        //     soundfile: this.state.soundfile,\n        //     soundster: this.state.soundster,\n        //     image: `https://loremflickr.com/g/200/200/${this.state.tags[0]}`,\n        //     favorite: false,\n        //     user_id: this.props.userId\n        //     // storedBlob: this.state.blob\n        // }\n\n        let formData = new FormData()\n        formData.append('audiocard[soundfile]', this.state.soundfile)\n        formData.append('audiocard[category]', this.state.category)\n        formData.append('audiocard[tags]', JSON.stringify(this.state.tags))\n        formData.append('audiocard[soundster]', this.state.soundster)\n        formData.append('audiocard[image]', `https://loremflickr.com/g/200/200/${this.state.tags[0]}`)\n        formData.append('audiocard[favorite]', false)\n        formData.append('audiocard[user_id]', this.props.userId)\n        \n        // this.props.updateAudioForm(recorderFormData)\n\n        // blob conversion\n        // let newAudio = new Audio(this.state.blob)\n        \n        \n        \n        if(Object.values(this.state).every(k => k !== \"\" || k.length !== 0)){\n            this.setState({displayErrors: false})\n            alert(\"Successfully Saved!\")\n            this.props.createRecording(formData)\n        } else {\n            return this.setState({displayErrors: true})\n        }\n\n        \n\n    }\n\n\n    \n    render(){\n        //animate gears \n\n        const rotateGears = e => {\n            document.querySelector('.gear1').style.animation = \"rotation 8s infinite linear\"\n            document.querySelector('.gear2').style.animation = \"rotation 8s infinite linear\"\n            this.startRecording()\n            console.log(\"RECORDING\")\n        }\n\n        const stopGears = e => {\n            document.querySelector('.gear1').style.animation = \"\"\n            document.querySelector('.gear2').style.animation = \"\"\n            this.setState({record: false})\n            if(this.state.playing){\n                this.stopRecording()\n            }\n            console.log(\"STOPPING\")\n        }\n\n        const playGears = e => {\n            document.querySelector('.gear1').style.animation = \"rotation 8s infinite linear\"\n            document.querySelector('.gear2').style.animation = \"rotation 8s infinite linear\"\n            this.playRecording()\n            console.log(\"PLAYING\")\n        }\n\n\n        //options for category input\n        const categoryOptions = [\n            { key:1, value: 'quotes', text: 'quotes', icon: 'comment alternate'},\n            { key:2, text: 'Music', value: 'music', icon: 'music'},\n            { key:3, text: 'Nature', value: 'nature', icon: 'leaf'},\n            { key:4, text: 'Joke', value: 'joke', icon: 'smile'},\n            { key:5, text: 'Health', value: 'health', icon: 'hand spock'},\n            { key:6, text: 'Personal', value: 'personal', icon: 'user secret'},\n            { key:7, text: 'Mechanical', value: 'mechanical', icon: 'wrench'},\n            { key:8, text: 'Other', value: 'other', icon: 'find'},\n        ]\n\n        const getclassName = this.state.displayErrors ? 'displayErrors' : ''\n\n        return (\n            <div className='mainRecContainer'>\n                <Form className={getclassName} onSubmit={this.handleSubmit} noValidate> \n                    <div className='cassette'>\n                        <div className='gear1'>\n                            <span className='helper'></span>\n                        </div>\n                        <div className='gear2'>\n                            <span className='helper'></span>\n                        </div>\n                        <div className='soundsterContainer'>\n                            <div className='soundster-input'>\n                                <Form.Input onChange={this.handleChange}\n                                    className=\"soundster-input-box\"\n                                    placeholder=\"Sound source\"\n                                    name='soundster'\n                                />\n                            </div>\n                            <div className='category-input'>\n                                <Form.Select onChange={this.handleChange} \n                                    placeholder=\"Category\"\n                                    options={categoryOptions}\n                                    name='category' \n                                />\n                            </div>\n                            <div className='tag-input' style={{width: \"550px\"}}>\n                                    <Grid>\n                                        <Grid.Row columns={2}>\n                                            <Grid.Column width={6}>\n                                                <OnEvent space={this.addTag}>\n                                                    <Form.Input\n                                                        style={{width: \"200px\"}}\n                                                        placeholder=\"Add tags\"\n                                                        name='addTags'\n                                                        icon\n                                                    >\n                                                        <input />\n                                                        <Icon name='tag' />\n                                                    </Form.Input>\n                                                </OnEvent>\n                                            </Grid.Column>\n                                            <Grid.Column width={10}>\n                                                <Grid>\n                                                    <Grid.Row columns={2}>\n                                                            {this.state.tags.map((tag, index) => {\n                                                                return  <Button onClick={e => this.deleteTag(tag)}\n                                                                            color='teal'\n                                                                            icon name='delete'\n                                                                            key={index}\n                                                                            labelPosition='right'\n                                                                            style={{margin:\"10px 5px 0px 10x\"}}\n                                                                            >{tag}\n                                                                                <Icon name='delete' />\n                                                                        </Button>\n                                                            })}\n                                                    </Grid.Row>\n                                                </Grid>\n                                            </Grid.Column>\n                                        </Grid.Row>\n                                    </Grid>\n                            </div>\n                        </div>\n                        \n                    </div>\n                    <div className='recordingContainer'>\n                        <ReactMic\n                            record={this.state.record}\n                            className=\"sound-wave\"\n                            onStop={this.onStop}\n                            strokeColor=\"#D4E6D7\"\n                            backgroundColor=\"#8FC6B4\"\n                            mimeType=\"audio/webm\" \n                            duration={30}\n                            />\n                    </div>\n                    <Form.Group className=\"recorderButtons\" style={{margin: \"10px 0px 10px 465px\"}}>\n                        <Form.Button type=\"button\" attached='bottom' className='recordButton' color=\"olive\" onClick={rotateGears}>\n                            <Icon name='microphone' />\n                            Record \n                        </Form.Button>\n                        <Form.Button type=\"onStop\" attached='bottom' className='stopButton' onClick={stopGears}>\n                            <Icon name='stop' />\n                            Stop   \n                        </Form.Button>\n                        <Form.Button type=\"button\" attached='bottom'className='playButton' onClick={playGears}>\n                            <Icon name='play' />\n                            Play\n                        </Form.Button>\n                        <Form.Button type='Submit' className= 'saveButton' color=\"orange\">\n                            <Icon name='paper plane outline' />\n                            Save\n                        </Form.Button>\n                    </Form.Group>\n                </Form>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    const userId = state.currentUser ? state.currentUser.id : \"\"\n    return {\n        audioForm: state.audioForm,\n        userId\n    }\n}\n\n// const mapStateToProps = state => {\n//     return {\n//         storedRecording: state.storedRecording,\n//         blob: state.storedBlob\n//     }\n// }\n\nexport default connect(mapStateToProps, {updateAudioForm, createRecording, addAudiocard})(Recorder)"]},"metadata":{},"sourceType":"module"}